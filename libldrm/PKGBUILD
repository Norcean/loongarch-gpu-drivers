# Maintainer: zint <zint@tuta.io>
# Contributor: zint <zint@tuta.io>

pkgname=libldrm
pkgver=1.0.2
_pkgver=${pkgver}-lnd25.1~rc1.7
pkgrel=1
pkgdesc="LOONGGPU ldrm library"
license=()
arch=(loong64)
makedepends=(
	binutils
	libarchive
	)
options=(!debug !strip)
source=(
	"https://pkg.loongnix.cn/loongnix/25/pool/non-free/l/loonggpu-graphics-drivers/libldrm_${_pkgver}_${arch}.deb"
)
b2sums=(
	"598275110c298a5744cd184b10e84d37b30692c8372a2696c33e24f4cac16ccfda84b6bc99944a867b6d91599559874916208bb501d57a530a8461c36a89f1a3"
)

prepare(){
	bsdtar -xf "${srcdir}/data."*
}
package(){
	install -Dm755 "${srcdir}/usr/lib/loongarch64-linux-gnu/libldrm.so.1.0.0" "${pkgdir}/usr/lib/libldrm.so.1.0.0"

	pushd "${pkgdir}/usr/lib"
	ln -s libldrm.so.1.0.0 libldrm.so.1
	popd

	install -Dm644 ${srcdir}/usr/share/libldrm/loonggpu.ids ${pkgdir}/usr/share/libldrm/loonggpu.ids

	install -Dm644 ${srcdir}/usr/share/doc/libldrm/copyright ${pkgdir}/usr/share/doc/libldrm/copyright
}
