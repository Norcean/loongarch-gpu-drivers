# Maintainer: zint <zint@tuta.io>
# Contributor: zint <zint@tuta.io>

pkgname=loonggl
pkgver=1.0.1
_pkgver=1.0.1-alpha-lnd25.5
pkgrel=1
pkgdesc="LOONGGPU binary OpenGL|ES|EGL|GLX library
 This package contains the development environment required for compiling
 programs against EGL native platform graphics interface library.
 EGL provides a platform-agnostic mechanism for creating rendering surfaces
 for use with other graphics libraries, such as OpenGL|ES|EGL|GLX."
license=()
arch=(loong64)
makedepends=(
	binutils
	libarchive
)
depends=(
	linux-firmware-loongson
	libldrm
	libloong-gpucomp
	libglvnd
	)
options=(!debug !strip)
source=(
	"https://pkg.loongnix.cn/loongnix/25/pool/main/l/loonggl/loonggl_${_pkgver}_${arch}.deb"
)
b2sums=(
	"20af98f7da58bb1be18e2fbbbd7f11606a1347e45949338d164d2efa7a29cacee3a871d7cec4d4f0d8bdaaaf13382b1c293abce7406ceb38cce64ac98f72620b"
)

prepare(){
	bsdtar -xf "${srcdir}/data."*
}
package(){

	cp -r "${srcdir}/etc" "${pkgdir}/etc"
	rm -r "${pkgdir}/etc/init.d"

	mkdir -p "${pkgdir}/usr/"
	cp -r "${srcdir}/usr/lib/loongarch64-linux-gnu/" "${pkgdir}/usr/lib/"

	install -Dm644 "${srcdir}/usr/share/glvnd/egl_vendor.d/60_loonggpu.json" "${pkgdir}/usr/share/glvnd/egl_vendor.d/60_loonggpu.json"

	install -Dm644 ${srcdir}/usr/share/doc/loonggl/copyright ${pkgdir}/usr/share/doc/loonggl/copyright
}
