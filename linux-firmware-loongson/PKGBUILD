# Maintainer: zint <zint@tuta.io>
# Contributor: zint <zint@tuta.io>

pkgname=linux-firmware-loongson
pkgver=1.0.1
_pkgver=1.0.1-alpha-lnd25.5
pkgrel=1
pkgdesc="This package contains the binary firmware for loongson graphics chips supported by the gsgpu drivers."
license=()
arch=(loong64)
makedepends=(
	zstd
	)
options=(!debug !strip)
source=("https://pkg.loongnix.cn/loongnix/25/pool/main/f/firmware-loongson-graphics/firmware-loongson-graphics_${_pkgver}_${arch}.deb")
b2sums=("b6661ee351c205c6f4eb81538fa9eec933f73f785367c2b35e333727cae7f2055aada0cc7e80ae9381979a7c6907ef9b5f6babee945941e64e31dc3497fddf15")

prepare(){
	bsdtar -xf "${srcdir}/data."*
}
build(){
	cd ${srcdir}
	zstd -19 lib/firmware/loonggpu/lg100_cp.bin -o lib/firmware/loonggpu/lg100_cp.bin.zst
}
package(){
	install -Dm644 ${srcdir}/lib/firmware/loonggpu/lg100_cp.bin.zst ${pkgdir}/usr/lib/firmware/loonggpu/lg100_cp.bin.zst

	install -Dm644 ${srcdir}/usr/share/doc/firmware-loongson-graphics/copyright ${pkgdir}/usr/share/doc/firmware-loongson-graphics/copyright
	install -Dm644 ${srcdir}/usr/share/metainfo/firmware-loongson-graphics.metainfo.xml ${pkgdir}/usr/share/metainfo/firmware-loongson-graphics.metainfo.xml
}
